<?xml version="1.0"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009"
                       xmlns:parsley="http://www.spicefactory.org/parsley"
                       xmlns="*"
                       title="SpaceTycoon" width="1100" height="700"
                       backgroundColor="0x937f50"
                       xmlns:s="library://ns.adobe.com/flex/spark"
                       showStatusBar="false"
                       frameRate="60"
                       addedToStage="addedToStage()">

    <fx:Declarations>

        <parsley:ContextBuilder config="Config" />
        <parsley:Configure />

    </fx:Declarations>

    <!--<fx:Style>-->
    <!--@namespace s "library://ns.adobe.com/flex/spark";-->

    <!--@font-face {-->
    <!--embedAsCFF: true;-->
    <!--src: url("assets/OpenSans-Light.ttf");-->
    <!--fontFamily: "opensansl";-->
    <!--}-->

    <!--global {-->
    <!--fontFamily: "opensansl";-->
    <!--fontSize: 14px;-->
    <!--}-->
    <!--</fx:Style>-->

    <fx:Script>

        import st.Player;
        import st.Ship;

        [Inject]
        public var player:Player;

        [MessageDispatcher]
        public var send:Function;

        private function addedToStage():void
        {
            this.visible = true;
            this.stage.displayState = StageDisplayState.FULL_SCREEN_INTERACTIVE;
            this.stage.addEventListener(KeyboardEvent.KEY_UP, onKeyUp, false, 0, true);
            trace("Init");
        }

        [Init]
        public function onParsleyInit():void
        {
            send(new Ship());
        }

        private static function onKeyUp(event:KeyboardEvent):void
        {
            if (event.keyCode == Keyboard.ESCAPE) {
                if (NativeApplication.nativeApplication) {
                    NativeApplication.nativeApplication.exit();
                }
            }
        }

    </fx:Script>

    <s:BitmapImage source="{ImageLib.BACKGROUND}" width="100%" height="100%" />

    <PlayState />

</s:WindowedApplication>
