<?xml version="1.0"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009"
                       xmlns:parsley="http://www.spicefactory.org/parsley"
                       xmlns="*"
                       title="SpaceTycoon" width="1600" height="1200"
                       backgroundColor="0x937f50"
                       xmlns:s="library://ns.adobe.com/flex/spark"
                       showStatusBar="false"
                       frameRate="60"
                       addedToStage="addedToStage()">

    <fx:Style>
        global {
            font-size: 16px;
            fontFamily: "Open Sans Light";
            color: #050505;
        }
    </fx:Style>

    <fx:Declarations>
        <parsley:ContextBuilder config="Config" />
        <parsley:Configure />
    </fx:Declarations>

    <!--<fx:Style>-->
    <!--@namespace s "library://ns.adobe.com/flex/spark";-->

    <!--@font-face {-->
    <!--embedAsCFF: true;-->
    <!--src: url("assets/OpenSans-Light.ttf");-->
    <!--fontFamily: "opensansl";-->
    <!--}-->

    <!--global {-->
    <!--fontFamily: "opensansl";-->
    <!--fontSize: 14px;-->
    <!--}-->
    <!--</fx:Style>-->

    <fx:Script>

        import mx.core.IVisualElement;
        import mx.core.UIComponent;

        import st.Player;

        [Inject]
        public var player:Player;

        [MessageDispatcher]
        public var send:Function;

        private function addedToStage():void
        {
            this.stage.displayState = StageDisplayState.FULL_SCREEN_INTERACTIVE;
            visible = true;
            stage.addEventListener(KeyboardEvent.KEY_UP, onKeyUp, false, 0, true);
            trace("Init");
        }

        [Init]
        public function onParsleyInit():void
        {
            var ui:UIComponent = new UIComponent();
            ui.addChild(new FPSCounter());
            this.addElement(ui as IVisualElement);
        }

        private function onKeyUp(event:KeyboardEvent):void
        {
            if (event.keyCode == Keyboard.ESCAPE) {
                if (NativeApplication.nativeApplication) {
                    NativeApplication.nativeApplication.exit();
                }
            }

            if (event.keyCode == Keyboard.F &amp;&amp; event.ctrlKey) {
                if (NativeApplication.nativeApplication) {
                    if (stage.displayState == StageDisplayState.NORMAL)
                        stage.displayState = StageDisplayState.FULL_SCREEN_INTERACTIVE;
                    else
                        stage.displayState = StageDisplayState.NORMAL;

                }
            }
        }

    </fx:Script>

    <s:BitmapImage source="{ImageLib.BACKGROUND}" width="100%" height="100%" />

    <PlayState />

</s:WindowedApplication>
